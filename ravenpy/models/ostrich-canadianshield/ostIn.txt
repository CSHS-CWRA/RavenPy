ProgramType         DDS
ObjectiveFunction   GCOP
ModelExecutable     ./ostrich-runs-raven.sh
PreserveBestModel   ./save_best.sh
#OstrichWarmStart   yes

ModelSubdir processor_

BeginExtraDirs
model
#best
EndExtraDirs

BeginFilePairs
  raven-canadianshield.rvp.tpl;  raven-canadianshield.rvp
  raven-canadianshield.rvc.tpl;  raven-canadianshield.rvc
  raven-canadianshield.rvh.tpl;  raven-canadianshield.rvh
  raven-canadianshield.rvt.tpl;  raven-canadianshield.rvt
  #can be multiple (.rvh, .rvi)
EndFilePairs

#Parameter/DV Specification
BeginParams
  #parameter init.    low                   high                    tx_in  tx_ost  tx_out
  par_x01    random   {lowerBounds.par_x01} {upperBounds.par_x01}   none   none    none # SoilProfiles:            thickness TOPSOIL (m)
  par_x02    random   {lowerBounds.par_x02} {upperBounds.par_x02}   none   none    none # SoilProfiles:            thickness VADOSE (m) in organic soil class only
  par_x03    random   {lowerBounds.par_x03} {upperBounds.par_x03}   none   none    none # SoilProfiles:            thickness FRACBEDROCK (m)
  par_x04    random   {lowerBounds.par_x04} {upperBounds.par_x04}   none   none    none # SoilParameterList:       PET_CORRECTION TOPSOIL
  par_x05    random   {lowerBounds.par_x05} {upperBounds.par_x05}   none   none    none # SoilParameterList:       SAT_WILT TOPSOIL
  par_x06    random   {lowerBounds.par_x06} {upperBounds.par_x06}   none   none    none # SoilParameterList:       FIELD_CAPACITY TOPSOIL = SAT_WILT TOPSOIL + x05
  par_x07    random   {lowerBounds.par_x07} {upperBounds.par_x07}   none   none    none # SoilParameterList:       HBV_BETA TOPSOIL
  par_x08    random   {lowerBounds.par_x08} {upperBounds.par_x08}   none   none    none # SoilParameterList:       BASEFLOW_COEFF VADOSE = 10^x08
  par_x09    random   {lowerBounds.par_x09} {upperBounds.par_x09}   none   none    none # SoilParameterList:       BASEFLOW_COEFF FRACBEDROCK = 10^x09
  par_x10    random   {lowerBounds.par_x10} {upperBounds.par_x10}   none   none    none # SoilParameterList:       BASEFLOW_N VADOSE
  par_x11    random   {lowerBounds.par_x11} {upperBounds.par_x11}   none   none    none # SoilParameterList:       BASEFLOW_N FRACBEDROCK
  par_x12    random   {lowerBounds.par_x12} {upperBounds.par_x12}   none   none    none # SoilParameterList:       MAX_INTERFLOW_RATE TOPSOIL
  par_x13    random   {lowerBounds.par_x13} {upperBounds.par_x13}   none   none    none # SoilParameterList:       MAX_PERC_RATE TOPSOIL
  par_x14    random   {lowerBounds.par_x14} {upperBounds.par_x14}   none   none    none # SoilParameterList:       MAX_PERC_RATE VADOSE
  par_x15    random   {lowerBounds.par_x15} {upperBounds.par_x15}   none   none    none # GlobalParameter:         SNOW_SWI
  par_x16    random   {lowerBounds.par_x16} {upperBounds.par_x16}   none   none    none # GlobalParameter:         SNOW_SWI_MIN
  par_x17    random   {lowerBounds.par_x17} {upperBounds.par_x17}   none   none    none # GlobalParameter:         SNOW_SWI_MAX = SNOW_SWI_MIN + x16
  par_x18    random   {lowerBounds.par_x18} {upperBounds.par_x18}   none   none    none # GlobalParameter:         SWI_REDUCT_COEFF
  par_x19    random   {lowerBounds.par_x19} {upperBounds.par_x19}   none   none    none # GlobalParameter:         RAINSNOW_TEMP (dC)
  par_x20    random   {lowerBounds.par_x20} {upperBounds.par_x20}   none   none    none # GlobalParameter:         RAINSNOW_DELTA (dC)
  par_x21    random   {lowerBounds.par_x21} {upperBounds.par_x21}   none   none    none # GlobalParameter:         MAX_SWE_SURFACE (mm)
  par_x22    random   {lowerBounds.par_x22} {upperBounds.par_x22}   none   none    none # GlobalParameter:         TOC_MULTIPLIER
  par_x23    random   {lowerBounds.par_x23} {upperBounds.par_x23}   none   none    none # LandUseParameterList:    REFREEZE_FACTOR
  par_x24    random   {lowerBounds.par_x24} {upperBounds.par_x24}   none   none    none # LandUseParameterList:    DD_MELT_TEMP
  par_x25    random   {lowerBounds.par_x25} {upperBounds.par_x25}   none   none    none # LandUseParameterList:    MELT_FACTOR
  par_x26    random   {lowerBounds.par_x26} {upperBounds.par_x26}   none   none    none # LandUseParameterList:    DEP_MAX (mm)
  par_x27    random   {lowerBounds.par_x27} {upperBounds.par_x27}   none   none    none # LandUseParameterList:    OW_PET_CORR
  par_x28    random   {lowerBounds.par_x28} {upperBounds.par_x28}   none   none    none # VegetationParameterList: RAIN_ICEPT_FACT
  par_x29    random   {lowerBounds.par_x29} {upperBounds.par_x29}   none   none    none # VegetationParameterList: SNOW_ICEPT_FACT
  par_x30    random   {lowerBounds.par_x30} {upperBounds.par_x30}   none   none    none # VegetationParameterList: MAX_CAPACITY (mm)
  par_x31    random   {lowerBounds.par_x31} {upperBounds.par_x31}   none   none    none # VegetationParameterList: MAX_SNOW_CAPACITY (mm)
  par_x32    random   {lowerBounds.par_x32} {upperBounds.par_x32}   none   none    none # Gauge:                   RAINCORRECTION
  par_x33    random   {lowerBounds.par_x33} {upperBounds.par_x33}   none   none    none # Gauge:                   SNOWCORRECTION
  par_x34    random   {lowerBounds.par_x34} {upperBounds.par_x34}   none   none    none # HRUs:                    ratio to derive fraction of organic soil (x34*AREA) and bedrock ((1-x34)*AREA)
EndParams

BeginTiedParams
  #
  par_sum_x05_x06  2 par_x05 par_x06 linear 0.00 1.00 1.00 0.00 free
  par_sum_x16_x17  2 par_x16 par_x17 linear 0.00 1.00 1.00 0.00 free
  par_pow_x08      1 par_x08         exp    10.0 1.00 1.00 0.00 free
  par_pow_x09      1 par_x09         exp    10.0 1.00 1.00 0.00 free
  par_half_x01     1 par_x01         linear 500.0     0.00      free
  par_half_x02     1 par_x02         linear 500.0     0.00      free
  par_half_x03     1 par_x03         linear 500.0     0.00      free
  #
  # AREA HRU1=SOILP_ORG (km2)
  # soil organic area = x34 * AREA
  # area SB1 = {area}
  par_area_organic_SB1 1 par_x34         linear  {area}      0.0    free
  #
  # AREA HRU2=SOILP_BEDROCK (km2)
  # soil bedrock area = (1-x34)*AREA = AREA - x34 * AREA
  # area SB1 = {area}
  par_area_bedrock_SB1 1 par_x34         linear -{area}   {area}    free
  #
EndTiedParams

BeginResponseVars
  #name   filename                              keyword         line    col     token
  NS      ./model/output/{run_name}-{run_index}_Diagnostics.csv;       OST_NULL        1       3       ','
EndResponseVars

BeginTiedRespVars
  NegNS 1 NS wsum -1.00
EndTiedRespVars

BeginGCOP
  CostFunction NegNS
  PenaltyFunction APM
EndGCOP

BeginConstraints
        # not needed when no constraints, but PenaltyFunction statement above is required
        # name     type     penalty    lwr   upr   resp.var
EndConstraints

# Randomsed control added
#RandomSeed 1615909479
RandomSeed 0

#Algorithm should be last in this file:

BeginDDSAlg
        PerturbationValue 0.20
        MaxIterations 10
        UseRandomParamValues
        # UseInitialParamValues
        # above intializes DDS to parameter values IN the initial model input files
EndDDSAlg
